# openclaw-trader 模拟盘配置
# 场景 = 策略(strategy_id) × 市场(exchange)
# 每个场景独立账户：logs/paper-{id}.json
# 对比报告：npm run paper:compare

report_interval_hours: 24

scenarios:

  # ══════════════════════════════════════════
  # 保守策略组
  # ══════════════════════════════════════════

  - id: "conservative-spot"
    name: "保守 × 现货"
    enabled: true
    strategy_id: "conservative"
    initial_usdt: 10000
    fee_rate: 0.001
    slippage_percent: 0.05
    exchange:
      market: "spot"
      leverage:
        enabled: false
        default: 1
        max: 1

  - id: "conservative-futures-3x"
    name: "保守 × 合约 3x"
    enabled: true
    strategy_id: "conservative"
    initial_usdt: 10000
    fee_rate: 0.0004
    slippage_percent: 0.08
    exchange:
      market: "futures"
      futures:
        contract_type: "perpetual"
        margin_mode: "isolated"
      leverage:
        enabled: true
        default: 3
        max: 3
    # 合约下进一步收紧保守策略的风控
    risk:
      stop_loss_percent: 3
      take_profit_percent: 9
      trailing_stop:
        enabled: true
        activation_percent: 5
        callback_percent: 1.5
      position_ratio: 0.1
      max_positions: 3
      max_position_per_symbol: 0.2
      max_total_loss_percent: 12
      daily_loss_limit_percent: 4

  # ══════════════════════════════════════════
  # 激进策略组
  # ══════════════════════════════════════════

  - id: "aggressive-spot"
    name: "激进 × 现货"
    enabled: true
    strategy_id: "aggressive"
    initial_usdt: 10000
    fee_rate: 0.001
    slippage_percent: 0.05
    exchange:
      market: "spot"
      leverage:
        enabled: false
        default: 1
        max: 1

  - id: "aggressive-futures-3x"
    name: "激进 × 合约 3x"
    enabled: true
    strategy_id: "aggressive"
    initial_usdt: 10000
    fee_rate: 0.0004
    slippage_percent: 0.1
    exchange:
      market: "futures"
      futures:
        contract_type: "perpetual"
        margin_mode: "isolated"
      leverage:
        enabled: true
        default: 3
        max: 3
    risk:
      stop_loss_percent: 4
      take_profit_percent: 12
      trailing_stop:
        enabled: true
        activation_percent: 3
        callback_percent: 1
      position_ratio: 0.15
      max_positions: 4
      max_position_per_symbol: 0.3
      max_total_loss_percent: 20
      daily_loss_limit_percent: 8

  # ══════════════════════════════════════════
  # 趋势跟踪策略组
  # ══════════════════════════════════════════

  - id: "trend-spot"
    name: "趋势 × 现货"
    enabled: true
    strategy_id: "trend"
    initial_usdt: 10000
    fee_rate: 0.001
    slippage_percent: 0.05
    exchange:
      market: "spot"
      leverage:
        enabled: false
        default: 1
        max: 1

  - id: "trend-futures-5x"
    name: "趋势 × 合约 5x"
    enabled: false              # 5x 杠杆风险较大，默认关闭
    strategy_id: "trend"
    initial_usdt: 10000
    fee_rate: 0.0004
    slippage_percent: 0.12
    exchange:
      market: "futures"
      futures:
        contract_type: "perpetual"
        margin_mode: "isolated"
      leverage:
        enabled: true
        default: 5
        max: 5
    risk:
      stop_loss_percent: 2
      take_profit_percent: 10
      trailing_stop:
        enabled: true
        activation_percent: 3
        callback_percent: 1
      position_ratio: 0.06
      max_positions: 2
      max_position_per_symbol: 0.15
      max_total_loss_percent: 8
      daily_loss_limit_percent: 3

  # ══════════════════════════════════════════
  # RSI 均值回归策略组
  # ══════════════════════════════════════════

  - id: "rsi-spot"
    name: "RSI均值回归 × 现货"
    enabled: true
    strategy_id: "rsi-pure"
    initial_usdt: 10000
    fee_rate: 0.001
    slippage_percent: 0.05
    exchange:
      market: "spot"
      leverage:
        enabled: false
        default: 1
        max: 1

  - id: "rsi-margin-2x"
    name: "RSI均值回归 × 杠杆2x"
    enabled: true
    strategy_id: "rsi-pure"
    initial_usdt: 10000
    fee_rate: 0.001
    slippage_percent: 0.06
    exchange:
      market: "margin"
      leverage:
        enabled: true
        default: 2
        max: 2
    risk:
      stop_loss_percent: 4
      take_profit_percent: 8
      trailing_stop:
        enabled: false
        activation_percent: 5
        callback_percent: 2
      position_ratio: 0.12
      max_positions: 4
      max_position_per_symbol: 0.25
      max_total_loss_percent: 18
      daily_loss_limit_percent: 6

  # ══════════════════════════════════════════
  # Binance Testnet（真实 API，虚拟资金）
  # 申请地址：https://testnet.binance.vision
  # 凭证文件：.secrets/binance-testnet.json
  # ══════════════════════════════════════════

  - id: "testnet-default"
    name: "Testnet × 默认策略"
    enabled: true               # ✅ 已配置 .secrets/binance-testnet.json
    strategy_id: "default"      # 使用 strategy.yaml 默认配置
    initial_usdt: 10000         # 与 Testnet 账户实际余额保持一致
    fee_rate: 0.001
    slippage_percent: 0
    exchange:
      market: "spot"
      testnet: true             # ← 关键：true = testapi.binance.vision
      credentials_path: ".secrets/binance-testnet.json"
      leverage:
        enabled: false
        default: 1
        max: 1
    # ATR 动态仓位（Testnet 开启验证效果）
    risk:
      stop_loss_percent: 5
      take_profit_percent: 15
      trailing_stop:
        enabled: true
        activation_percent: 8
        callback_percent: 2
      position_ratio: 0.2       # ATR 不生效时的 fallback 仓位
      max_positions: 3
      max_position_per_symbol: 0.3
      max_total_loss_percent: 20
      daily_loss_limit_percent: 8
      # ATR 动态仓位（可选，优先于 position_ratio）
      atr_position:
        enabled: true
        risk_per_trade_percent: 2   # 每笔最多亏 2% 总资金
        atr_multiplier: 1.5         # 止损距离 = 1.5×ATR
        max_position_ratio: 0.3     # 仓位上限 30%
      # 分批止盈
      take_profit_stages:
        - at_percent: 8            # 盈利 8% 时
          close_ratio: 0.5         # 平掉 50% 仓位
        - at_percent: 12           # 盈利 12% 时
          close_ratio: 0.5         # 再平掉剩余 50%
      # 时间止损
      time_stop_hours: 72          # 持仓超过 72h 且无盈利则强制出场
