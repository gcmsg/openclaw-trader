# openclaw-trader 模拟盘配置
# 场景 = 策略(strategy_id) × 市场(exchange)
# 每个场景独立账户：logs/paper-{id}.json
# 对比报告：npm run paper:compare

report_interval_hours: 24

scenarios:

  # ══════════════════════════════════════════
  # 保守策略组
  # ══════════════════════════════════════════

  - id: "conservative-spot"
    name: "保守 × 现货"
    enabled: false              # 无历史数据，暂停
    strategy_id: "conservative"
    # F4 Strategy Plugin 示例（在策略 YAML 中设置，不在 scenario 级别设置）：
    # 在 config/strategies/conservative.yaml 中添加：
    #   strategy_id: "rsi-reversal"    # 使用 RSI 均值回归插件策略
    # 或:
    #   strategy_id: "breakout"        # 使用趋势突破插件策略
    initial_usdt: 10000
    fee_rate: 0.001
    slippage_percent: 0.05
    exchange:
      market: "spot"
      leverage:
        enabled: false
        default: 1
        max: 1

  - id: "conservative-futures-3x"
    name: "保守 × 合约 3x"
    enabled: false              # 无历史数据，暂停
    strategy_id: "conservative"
    initial_usdt: 10000
    fee_rate: 0.0004
    slippage_percent: 0.08
    exchange:
      market: "futures"
      futures:
        contract_type: "perpetual"
        margin_mode: "isolated"
      leverage:
        enabled: true
        default: 3
        max: 3
    # 合约下进一步收紧保守策略的风控
    risk:
      stop_loss_percent: 3
      take_profit_percent: 9
      trailing_stop:
        enabled: true
        activation_percent: 5
        callback_percent: 1.5
      position_ratio: 0.1
      max_positions: 3
      max_position_per_symbol: 0.2
      max_total_loss_percent: 12
      daily_loss_limit_percent: 4

  # ══════════════════════════════════════════
  # 激进策略组
  # ══════════════════════════════════════════

  - id: "aggressive-spot"
    name: "激进 × 现货"
    enabled: true
    strategy_id: "aggressive"
    initial_usdt: 10000
    fee_rate: 0.001
    slippage_percent: 0.05
    exchange:
      market: "spot"
      leverage:
        enabled: false
        default: 1
        max: 1

  - id: "aggressive-futures-3x"
    name: "激进 × 合约 3x"
    enabled: false              # Phase A: 精简，只保留 3 核心场景
    strategy_id: "aggressive"
    initial_usdt: 10000
    fee_rate: 0.0004
    slippage_percent: 0.1
    exchange:
      market: "futures"
      futures:
        contract_type: "perpetual"
        margin_mode: "isolated"
      leverage:
        enabled: true
        default: 3
        max: 3
    risk:
      stop_loss_percent: 4
      take_profit_percent: 12
      trailing_stop:
        enabled: true
        activation_percent: 3
        callback_percent: 1
      position_ratio: 0.15
      max_positions: 4
      max_position_per_symbol: 0.3
      max_total_loss_percent: 20
      daily_loss_limit_percent: 8

  # ══════════════════════════════════════════
  # 趋势跟踪策略组
  # ══════════════════════════════════════════

  - id: "trend-spot"
    name: "趋势 × 现货"
    enabled: false              # 无历史数据，暂停
    strategy_id: "trend"
    initial_usdt: 10000
    fee_rate: 0.001
    slippage_percent: 0.05
    exchange:
      market: "spot"
      leverage:
        enabled: false
        default: 1
        max: 1

  - id: "trend-futures-5x"
    name: "趋势 × 合约 5x"
    enabled: false              # 5x 杠杆风险较大，默认关闭
    strategy_id: "trend"
    initial_usdt: 10000
    fee_rate: 0.0004
    slippage_percent: 0.12
    exchange:
      market: "futures"
      futures:
        contract_type: "perpetual"
        margin_mode: "isolated"
      leverage:
        enabled: true
        default: 5
        max: 5
    risk:
      stop_loss_percent: 2
      take_profit_percent: 10
      trailing_stop:
        enabled: true
        activation_percent: 3
        callback_percent: 1
      position_ratio: 0.06
      max_positions: 2
      max_position_per_symbol: 0.15
      max_total_loss_percent: 8
      daily_loss_limit_percent: 3

  # ══════════════════════════════════════════
  # RSI 均值回归策略组
  # ══════════════════════════════════════════

  - id: "rsi-spot"
    name: "RSI均值回归 × 现货"
    enabled: true
    strategy_id: "rsi-pure"
    initial_usdt: 10000
    fee_rate: 0.001
    slippage_percent: 0.05
    exchange:
      market: "spot"
      leverage:
        enabled: false
        default: 1
        max: 1

  - id: "rsi-margin-2x"
    name: "RSI均值回归 × 杠杆2x"
    enabled: false              # Phase A: 精简
    strategy_id: "rsi-pure"
    initial_usdt: 10000
    fee_rate: 0.001
    slippage_percent: 0.06
    exchange:
      market: "margin"
      leverage:
        enabled: true
        default: 2
        max: 2
    risk:
      stop_loss_percent: 4
      take_profit_percent: 8
      trailing_stop:
        enabled: false
        activation_percent: 5
        callback_percent: 2
      position_ratio: 0.12
      max_positions: 4
      max_position_per_symbol: 0.25
      max_total_loss_percent: 18
      daily_loss_limit_percent: 6

  # ══════════════════════════════════════════
  # Binance Testnet（真实 API，虚拟资金）
  # 申请地址：https://testnet.binance.vision
  # 凭证文件：.secrets/binance-testnet.json
  # ══════════════════════════════════════════

  - id: "testnet-default"
    name: "Testnet × 默认策略"
    enabled: true               # ✅ 已配置 .secrets/binance-testnet.json
    strategy_id: "long-short"   # 多空双向策略（替代纯多头 default）
    initial_usdt: 10000         # 与 Testnet 账户实际余额保持一致
    fee_rate: 0.001
    slippage_percent: 0.05       # 市价单典型滑点（0 会产生虚假乐观结果）
    exchange:
      market: "spot"
      testnet: true             # ← 关键：true = testapi.binance.vision
      credentials_path: ".secrets/binance-testnet.json"
      leverage:
        enabled: false
        default: 1
        max: 1
    # ATR 动态仓位（Testnet 开启验证效果）
    risk:
      stop_loss_percent: 5
      take_profit_percent: 15
      trailing_stop:
        enabled: true
        activation_percent: 8
        callback_percent: 2
      position_ratio: 0.2       # ATR 不生效时的 fallback 仓位
      max_positions: 3
      max_position_per_symbol: 0.3
      max_total_loss_percent: 20
      daily_loss_limit_percent: 8
      # ATR 动态仓位（可选，优先于 position_ratio）
      atr_position:
        enabled: true
        risk_per_trade_percent: 2   # 每笔最多亏 2% 总资金
        atr_multiplier: 1.5         # 止损距离 = 1.5×ATR
        max_position_ratio: 0.3     # 仓位上限 30%
      # 分批止盈
      take_profit_stages:
        - at_percent: 8            # 盈利 8% 时
          close_ratio: 0.5         # 平掉 50% 仓位
        - at_percent: 12           # 盈利 12% 时
          close_ratio: 0.5         # 再平掉剩余 50%
      # 时间止损
      time_stop_hours: 72          # 持仓超过 72h 且无盈利则强制出场
      # 保本止损（P8.1）
      break_even_profit: 0.03     # 盈利 ≥ 3% 后激活保本止损
      break_even_stop: 0.001      # 止损线移至入场价 +0.1%

  # ─── Futures Testnet 空头场景 ────────────────────────────────
  - id: futures-short-test
    name: "Futures Testnet 空头测试"
    enabled: false              # Phase A: 精简
    strategy_id: "short-trend"   # config/strategies/short-trend.yaml
    initial_usdt: 5000
    fee_rate: 0.0004             # Futures maker fee 0.02%, taker 0.04%
    slippage_percent: 0.03
    exchange:
      market: futures
      testnet: true
      credentials_path: ".secrets/binance-futures-testnet.json"
    symbols:
      - BTCUSDT
      - ETHUSDT
      - SOLUSDT
      - BNBUSDT
    risk:
      stop_loss_percent: 4
      take_profit_percent: 12
      trailing_stop:
        enabled: true
        activation_percent: 6
        callback_percent: 2.5
      position_ratio: 0.2
      max_positions: 3
      max_position_per_symbol: 0.3

  # ─── Futures Testnet 双向场景 ────────────────────────────────
  - id: futures-long-short
    name: "Futures Testnet 双向测试"
    enabled: false               # 先跑空头场景，稳定后再启用双向
    strategy_id: "long-short"   # config/strategies/long-short.yaml
    initial_usdt: 5000
    fee_rate: 0.0004
    slippage_percent: 0.03
    exchange:
      market: futures
      testnet: true
      credentials_path: ".secrets/binance-futures-testnet.json"

  # ══════════════════════════════════════════
  # DCA 分批建仓场景（极度恐惧时逐步抄底）
  # 启用方法：enabled: true
  # ══════════════════════════════════════════
  - id: "dca-spot"
    name: "DCA 分批建仓 × 现货"
    enabled: false              # 手动启用
    strategy_id: "conservative" # 用保守策略的信号触发入场
    initial_usdt: 10000
    fee_rate: 0.001
    slippage_percent: 0.05
    exchange:
      market: "spot"
      leverage:
        enabled: false
        default: 1
        max: 1
    risk:
      stop_loss_percent: 8       # DCA 场景止损更宽（留空间补仓）
      take_profit_percent: 20    # 等待更大反弹再止盈
      trailing_stop:
        enabled: true
        activation_percent: 8
        callback_percent: 3
      position_ratio: 0.08       # 每批 8%，3 批 = 总仓位 24%
      max_positions: 3
      max_position_per_symbol: 0.3
      max_total_loss_percent: 15
      daily_loss_limit_percent: 5
      dca:
        enabled: true
        tranches: 3              # 分 3 批建仓
        drop_pct: 3.0            # 跌 3% 追加下一批
        max_hours: 48            # 最多 DCA 持续 48h，超时停止追加
