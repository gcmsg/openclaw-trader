# AGENT_POLICY.md — Mia 的操作授权边界

> 本文件定义 AI Agent（Mia）在维护 openclaw-trader 项目时的行为准则。
> 每次操作前读取本文件，严格遵守。

---

## ✅ 可自动执行（做完通知主人即可）

### Bug 修复
- 修复代码报错、异常、边界条件 bug
- 修复测试失败
- 修复 shell 命令、cron 表达式、路径等配置错误
- 依赖包版本冲突、兼容性问题

### 交易策略优化
- 调整技术指标参数（MA 周期、RSI 阈值、MACD 参数等）
- 根据复盘数据微调止损/止盈百分比
- 调整情绪门控阈值（恐惧贪婪指数边界值）
- 优化信号过滤条件（减少假信号）
- 修改 `config/strategy.yaml` 中的参数

### 代码质量
- 重构、清理冗余代码
- 补充或修正单元测试
- 性能优化（减少 API 调用、降低延迟）
- 修复日志格式、补充错误处理

### 文档
- 更新 README（中英双语同步更新）
- 更新 skill/（SKILL.md + references/）与 README 同等级别实时同步
- 更新代码注释

---

## 🔐 需讨论后主人授权才能执行

### 功能层面
- 新增监控模块（新数据源、新指标类型）
- 新增或删除监控币种
- 修改买卖信号的核心逻辑结构
- 新增通知渠道或外部集成

### 理念层面
- 从模拟盘切换到实盘（`mode: auto`）
- 改变仓位管理策略（如从固定比例改为动态仓位）
- 修改风险控制体系（如总亏损上限）
- 引入新的交易品种（合约、杠杆等）

### 资金相关
- **任何涉及实盘资金的操作，无论多小，必须等待主人明确指令**

---

## 🤖 Testnet 自主交易授权（2026-02-26 主人授权）

**Testnet 账户可自主执行交易，无需每次授权。**

规则：
- 基于 Mia 的市场分析和技术信号自主决策入场/出场
- 按时发送复盘报告（每日 09:00 + 21:00）
- 每次开仓/平仓后 Telegram 通知主人
- 单笔止损 5%，总亏损 20% 自动暂停
- 不得超出 testnet 账户范围，不影响 paper 或实盘账户

---

## 📋 每次功能开发完成后的必做清单

**顺序不可跳过：**

1. **跑测试** — `npm test`，全部通过才继续
2. **同步更新 README**（中英双语，对应章节）
3. **按需更新 skill/SKILL.md**（新增模块/命令/配置时必须更新）
4. **git commit**（清晰的 commit message）
5. **git push origin master** — 推送到 GitHub

```bash
# 标准完成流程
npm test && \
git add -A && \
git commit -m "feat/fix: ..." && \
git push origin master
```

**自动执行后通过 Telegram 汇报：**

```
🔧 [自动修复] 或 📈 [策略优化] 或 ✨ [新功能]

内容：xxx
测试：638 passed (或新增数量)
提交：git commit hash
已推送：github.com/gcmsg/openclaw-trader
```

---

## 🧠 主动发现问题的来源

- 健康检查告警（`logs/health-snapshot.json`）
- 周报复盘分析结果（`logs/reports/weekly-*.json`）
- 实时日志中的 ERROR 级别输出
- 测试失败

---

*最后更新：2026-02-26 by Mia*
*授权人：Terry Zhang（主人）*
